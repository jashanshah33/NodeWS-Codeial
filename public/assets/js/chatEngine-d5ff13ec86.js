class chatEngine{constructor(e,s,t){this.chatBox=$("#"+e),this.userEmail=s,this.userName=t,this.socket=io.connect("http://35.183.126.12:5000"),this.userEmail&&this.connectionHandler()}connectionHandler(){let o=this;this.socket.on("connect",function(){o.socket.emit("join_room",{user_email:o.userEmail,chatroom:"socialBook"}),o.socket.on("user_joined",function(e){})}),$("#send_message_form").submit(function(e){e.preventDefault(),$.ajax({type:"post",url:"/chat/create",data:$("#send_message_form").serialize(),success:function(e){var s=$("#message_input").val();""!=s&&(o.socket.emit("send_msg",{message:s,user_email:o.userEmail,user_name:o.userName,chatroom:"socialBook"}),$("#message_input").val(""))},error:function(e){console.log(e.responseText)}})}),o.socket.on("receive_message",function(e){var s=$("<p>");let t="other";e.user_email==o.userEmail&&(t="self"),s.prepend($("<sub>",{html:e.user_name})),s.append($("<span>",{html:e.message})),s.addClass(t),$("#chat").append(s);e=document.getElementById("chat");e.scrollTop=e.scrollHeight})}}$("#chat_logo").click(function(e){e.stopPropagation(),$("#chat_box").css("display","flex");e=document.getElementById("chat");e.scrollTop=e.scrollHeight}),$("#chat_box").click(function(e){e.stopPropagation()}),$(document).click(function(){$("#chat_box").css("display","none")});