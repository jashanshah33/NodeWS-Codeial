class chatEngine{constructor(e,s,o){this.chatBox=$("#"+e),this.userEmail=s,this.userName=o,this.socket=io.connect("http://localhost:5000"),this.userEmail&&this.connectionHandler()}connectionHandler(){let t=this;this.socket.on("connect",function(){t.socket.emit("join_room",{user_email:t.userEmail,chatroom:"socialBook"}),t.socket.on("user_joined",function(e){})}),$("#send_message_form").submit(function(e){e.preventDefault(),$.ajax({type:"post",url:"/chat/create",data:$("#send_message_form").serialize(),success:function(e){var s=$("#message_input").val();""!=s&&(t.socket.emit("send_msg",{message:s,user_email:t.userEmail,user_name:t.userName,chatroom:"socialBook"}),$("#message_input").val(""))},error:function(e){console.log(e.responseText)}})}),t.socket.on("receive_message",function(e){var s=$("<p>");let o="other";e.user_email==t.userEmail&&(o="self"),s.prepend($("<sub>",{html:e.user_name})),s.append($("<span>",{html:e.message})),s.addClass(o),$("#chat").append(s);e=document.getElementById("chat");e.scrollTop=e.scrollHeight})}}$("#chat_logo").click(function(e){e.stopPropagation(),$("#chat_box").css("display","flex");e=document.getElementById("chat");e.scrollTop=e.scrollHeight}),$("#chat_box").click(function(e){e.stopPropagation()}),$(document).click(function(){$("#chat_box").css("display","none")});